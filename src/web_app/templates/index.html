<!DOCTYPE html>
<html lang="en" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NLP Resume Analyzer</title>
    <link href="{{ url_for('static', filename='css/tw-build.css') }}" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>body{font-family:'Inter',sans-serif;}</style>
</head>
<body class="transition-base">
    <div class="relative max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        
        <!-- Navigation -->
        <div class="flex justify-end mb-4 fade-in">
            <a href="/history" class="inline-flex items-center px-4 py-2 text-sm font-medium text-slate-700 hover:text-sky-600 dark:text-slate-300 dark:hover:text-sky-400 bg-white hover:bg-slate-50 dark:bg-slate-800 dark:hover:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-700 transition-colors">
                <span class="mr-2">ðŸ“‹</span>
                View History
            </a>
        </div>

        <!-- Header -->
        <header class="text-center mb-12 fade-in">
            <h1 class="text-4xl md:text-5xl font-bold tracking-tight">
                <span class="bg-gradient-to-r from-sky-500 to-cyan-400 bg-clip-text text-transparent">Resume Analyzer</span>
            </h1>
            <p class="mt-4 text-lg text-slate-600 dark:text-slate-400 max-w-2xl mx-auto">
                Get instant feedback on your resume against a job description.
            </p>
        </header>

        <!-- Form -->
        <form action="/analyze" method="post" enctype="multipart/form-data" class="space-y-12">
            <div class="grid md:grid-cols-2 gap-8 items-start">
                
                <!-- Left Column: Upload -->
                <div class="card-tw fade-in" style="animation-delay: 0.1s;">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-lg font-semibold">Your Resume</h2>
                        <span class="text-xs font-medium text-slate-400 dark:text-slate-500">Step 1</span>
                    </div>
                    <div id="dropZone" class="dropzone">
                        <input id="resume-upload" name="resume" type="file" accept=".pdf,.docx" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer" required>
                        
                        <!-- Prompt State -->
                        <div id="uploadPrompt" class="flex flex-col items-center justify-center space-y-3 text-center">
                            <div class="flex h-12 w-12 items-center justify-center rounded-full bg-slate-100 dark:bg-slate-800">
                                <svg class="h-6 w-6 text-slate-500 dark:text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/></svg>
                            </div>
                            <p class="text-sm font-medium">
                                <span class="text-sky-500 dark:text-sky-400">Click to upload</span> or drag and drop
                            </p>
                            <p class="text-xs text-slate-500 dark:text-slate-400">PDF or DOCX (Max 10MB)</p>
                        </div>

                        <!-- File Preview State -->
                        <div id="filePreview" class="hidden flex-col items-center justify-center space-y-3 text-center">
                             <div class="flex h-12 w-12 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/20">
                                <svg class="h-6 w-6 text-green-500 dark:text-green-400" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>
                            </div>
                            <p id="fileName" class="text-sm font-medium truncate max-w-full"></p>
                            <button type="button" id="removeFile" class="text-xs text-slate-500 hover:text-red-500 dark:hover:text-red-400 transition-colors">Remove file</button>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Job Description -->
                <div class="card-tw fade-in" style="animation-delay: 0.2s;">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-lg font-semibold">Job Description</h2>
                        <span class="text-xs font-medium text-slate-400 dark:text-slate-500">Step 2 (Optional)</span>
                    </div>
                    
                    <!-- Mode Toggle -->
                    <div class="mb-4 p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700">
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" id="qualityModeToggle" class="w-4 h-4 text-sky-500 rounded border-slate-300 dark:border-slate-600 focus:ring-sky-500 dark:focus:ring-sky-400">
                            <div class="flex-1">
                                <span class="text-sm font-medium text-slate-700 dark:text-slate-300">Quality Check Only</span>
                                <p class="text-xs text-slate-500 dark:text-slate-400 mt-0.5">Skip job matching and get resume quality feedback only</p>
                            </div>
                        </label>
                    </div>
                    
                    <textarea id="job_description" name="job_description" rows="12" class="input-base resize-y" placeholder="Paste the full job description here (leave empty for quality check only)..."></textarea>
                    
                    <p class="text-xs text-slate-500 dark:text-slate-400 mt-2">
                        ðŸ’¡ <span id="modeHint">Tip: Leave empty to get quality feedback without job matching</span>
                    </p>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="text-center fade-in" style="animation-delay: 0.3s;">
                <button type="submit" class="btn-primary-tw w-full md:w-auto">
                    Analyze My Resume
                </button>
            </div>
        </form>

        <!-- Footer -->
        <footer class="text-center mt-16 text-sm text-slate-500 dark:text-slate-400">
            <p>
                Built with Python & Tailwind CSS | 
                <a href="/skills" class="text-sky-500 hover:text-sky-600 dark:text-sky-400 dark:hover:text-sky-300 transition-colors">Explore Skills Database</a>
            </p>
            <button id="themeToggle" class="mt-4 btn-outline-tw text-xs">Toggle Theme</button>
        </footer>
    </div>

    <script>
        const themeBtn = document.getElementById('themeToggle');
        const htmlEl = document.documentElement;
        
        // Apply saved theme on load
        if (localStorage.getItem('theme') === 'dark') {
            htmlEl.classList.add('dark');
        }

        // Toggle theme
        themeBtn.addEventListener('click', () => {
            htmlEl.classList.toggle('dark');
            localStorage.setItem('theme', htmlEl.classList.contains('dark') ? 'dark' : 'light');
        });

        // File upload UI logic
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('resume-upload');
        const uploadPrompt = document.getElementById('uploadPrompt');
        const filePreview = document.getElementById('filePreview');
        const fileNameEl = document.getElementById('fileName');
        const removeFileBtn = document.getElementById('removeFile');

        function showFilePreview(file) {
            fileNameEl.textContent = file.name;
            uploadPrompt.classList.add('hidden');
            filePreview.classList.remove('hidden');
            filePreview.classList.add('flex');
        }

        function showUploadPrompt() {
            uploadPrompt.classList.remove('hidden');
            filePreview.classList.add('hidden');
            filePreview.classList.remove('flex');
        }

        dropZone.addEventListener('click', () => fileInput.click());
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });
        dropZone.addEventListener('dragleave', () => dropZone.classList.remove('dragover'));
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            if (e.dataTransfer.files.length > 0) {
                fileInput.files = e.dataTransfer.files;
                showFilePreview(fileInput.files[0]);
            }
        });
        fileInput.addEventListener('change', () => {
            if (fileInput.files.length > 0) {
                showFilePreview(fileInput.files[0]);
            }
        });
        removeFileBtn.addEventListener('click', (e) => {
            e.stopPropagation(); // Prevent dropzone click event
            fileInput.value = '';
            showUploadPrompt();
        });

        // Quality Mode Toggle
        const qualityToggle = document.getElementById('qualityModeToggle');
        const jobDescTextarea = document.getElementById('job_description');
        const modeHint = document.getElementById('modeHint');

        qualityToggle.addEventListener('change', function() {
            if (this.checked) {
                // Quality Check Mode enabled
                jobDescTextarea.disabled = true;
                jobDescTextarea.value = '';
                jobDescTextarea.classList.add('opacity-50', 'cursor-not-allowed');
                jobDescTextarea.placeholder = 'Quality Check Mode - Job description disabled';
                modeHint.textContent = 'Quality Check Mode: Get resume feedback without job matching';
            } else {
                // Full Analysis Mode
                jobDescTextarea.disabled = false;
                jobDescTextarea.classList.remove('opacity-50', 'cursor-not-allowed');
                jobDescTextarea.placeholder = 'Paste the full job description here (leave empty for quality check only)...';
                modeHint.textContent = 'Tip: Leave empty to get quality feedback without job matching';
            }
        });
    </script>
</body>
</html>